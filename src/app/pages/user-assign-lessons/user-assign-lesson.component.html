<div class="row">
  <nb-card style="width:100%">
    <nb-card-body>
      <div class="row mt-4">
        <div class="col-lg-6 mb-4 pr-4" style="border-right:0.5px solid rgb(204, 204, 204);">
          <div class="mb-3" style="font-size:16px;font-weight: 600;">
            <span>Đăng ký khóa học cho học viên: </span>
            <span class="elanco-color">Trần Trung Hiếu</span>
          </div>
          <div class="row">
            <div class="col-lg-5">
              <nz-input-group [nzPrefix]="prefixIconSearch" [nzSuffix]="suffixTemplate" style="width:100%;" class="mb-2">
                <input type="text" [(ngModel)]="searchText" nz-input size="small" placeholder="Tìm kiếm tên khóa học"
                  (keyup)="onKeyUp($event)" />
              </nz-input-group>
              <ng-template #prefixIconSearch>
                <nb-icon [icon]="'search'" pack="ion" style="font-weight:lighter;opacity: 30%;color:gray;"></nb-icon>
              </ng-template>
              <ng-template #suffixTemplate>
                <nb-icon *ngIf='searchText && searchText.length > 0' [icon]="'close'" pack="eva" style="font-weight:lighter;opacity: 50%;color:gray;"
                  (click)="clearSearch()"></nb-icon>
              </ng-template>
            </div>
            <div class="col-lg-7">
              <nz-tree-select style="width: 100%" nzPlaceHolder="Tìm theo phân loại sản phẩm" [(ngModel)]="selectedLessonCategories" [nzMaxTagCount]="3"
                [nzMaxTagPlaceholder]="omittedPlaceHolder" [nzNodes]="nodes" [nzDefaultExpandAll]="true"
                nzVirtualHeight="300px"

                [nzShowSearch]="true"
                [nzAllowClear]="true" [nzMultiple]="true" (ngModelChange)="onTreeSelectChange($event)"></nz-tree-select>
              <ng-template #omittedPlaceHolder let-omittedValues>+{{ omittedValues.length }}...</ng-template>
            </div>
          </div>


          <div class="text-right" style="width: 100%;">
            <button class="mb-2" nz-button nzType="primary" (click)="assignCurrentSelected()">Đăng ký danh sách đang chọn</button>
          </div>

          <nz-table #basicTable [nzData]="listOfData" style="width:100%" [nzShowPagination]="false" nzSize="small"
            [nzPageSize]="9999" [nzScroll]="{ x: '450px' }">
            <thead>
              <tr>
                <th nzWidth="60px" class="text-center">
                  <label nz-checkbox [(ngModel)]="isCheckedAll" (ngModelChange)="setSelectedAll()"></label>
                </th>
                <th><b>Khóa học</b></th>
                <th nzWidth="120px" class="text-center"><b>Có chứng chỉ</b></th>
              </tr>
            </thead>
            <tbody>
              <ng-container *ngFor="let data of basicTable.data">
                <tr>
                  <td class="text-center">
                    <label nz-checkbox [(ngModel)]="data.selected"></label>
                    <!-- <label nz-checkbox [(ngModel)]="data.selected" (ngModelChange)="setSelected(data)"></label> -->
                  </td>
                  <td>
                    <div><b>{{data.name}}</b></div>
                    <div>{{ data.category.length > 0 ? data.category.join(' | ') : '' }}</div>
                  </td>
                  <td class="text-center">
                    <nb-icon *ngIf="data.haveCertification === 'Có'" [icon]="'checkmark-circle-2-outline'" pack="eva"
                      style="font-weight:bold;color:#0067B1;"></nb-icon>
                  </td>
                </tr>
              </ng-container>
            </tbody>
          </nz-table>

        </div>
        <div class="col-lg-6 pl-4">
          <div class="elanco-color mb-3" style="font-size:16px;font-weight: 600;">Khóa học được đăng ký</div>
          <div class="row">
            <div class="col-md-12">
              <a nz-button nzType="default" (click)="removeAllSelected()">
                <span class="ml-1">Bỏ chọn tất cả</span>
              </a>

              <b class="ml-4">Đã chọn: {{ !listOfSelected ? 0 : listOfSelected?.length }}</b>
              <div class="float-right">
                <button class="mr-4" nz-button nzType="default" (click)="backToUser()">Hủy</button>
                <button nz-button nzType="primary" (click)="backToUser()">Lưu</button>
              </div>
            </div>
          </div>
          <br />

          <nz-table #selectedTable [nzData]="listOfSelected" style="width:100%" [nzShowPagination]="false"
            nzSize="small" [nzPageSize]="9999" style="min-height:450px" [nzScroll]="{ x: '450px' }">
            <tbody>
              <ng-container *ngFor="let data of selectedTable.data">
                <tr>
                  <td>
                    <div><b>{{data.name}}</b><span></span></div>
                    <div>{{ data.category.length > 0 ? data.category.join(' | ') : '' }}</div>
                  </td>
                  <td style="width:60px">
                    <nb-icon [icon]="'trash-a'" pack="ion" style="font-weight:lighter;color:red;opacity: 0.6;"
                      (click)="removeUserFromListSelected(data)"></nb-icon>
                  </td>
                </tr>
              </ng-container>
            </tbody>
          </nz-table>
        </div>
      </div>
    </nb-card-body>
  </nb-card>
</div>
